

# 1.Ünite - Kurulum ve PL/SQL’e Giriş

---

## 1. Giriş

**PL/SQL (Procedural Language/SQL)**, Oracle tarafından geliştirilen **prosedürel veritabanı programlama dili**dir.  
Amaç, SQL sorgularına **koşul, döngü, hata yönetimi** gibi programlama yapıları kazandırmaktır.  
Dil yapısı **Ada** ve **Pascal** dillerine benzer.

PL/SQL dili Oracle Database 6.0 (1991) sürümünde ortaya çıkmış, zamanla **prosedür, fonksiyon, trigger, paket** gibi yapılar eklenmiştir.  
Oracle dışında da benzer sürümler geliştirilmiştir:

- IBM DB2 → PL/SQL desteği (v9.7+)
    
- PostgreSQL → PL/pgSQL
    
- MariaDB → PL/SQL alt kümesi (v10.3+)
    

---

## 2. Gerekli Yazılımlar ve Kurulum

PL/SQL uygulamaları için gerekli bileşenler:

| Yazılım                                          | Amaç                    | Not                                              |
| ------------------------------------------------ | ----------------------- | ------------------------------------------------ |
| **Oracle VirtualBox**                            | Sanal makine çalıştırma | Windows üzerinde Oracle Linux imajı için gerekli |
| **Oracle Database 23c Free (Developer Release)** | Oracle veritabanı       | Linux tabanlı sanal imaj (.ova) kullanılır       |
| **Oracle SQL Developer**                         | SQL ve PL/SQL editörü   | Oracle hesabı ile indirilir                      |
| **VirtualBox Extension Pack**                    | Ek sürücü ve ağ desteği | VirtualBox ile birlikte kurulmalıdır             |

### Sanal Makine Özellikleri

- **OS:** Oracle Linux 8.7
    
- **DB:** Oracle Database 23.2 Free
    
- **Araçlar:** Oracle REST Data Services, APEX, SQLcl
    

**Minimum sistem gereksinimleri:**  
4 GB RAM, 20 GB disk, 2 CPU çekirdeği  
(önerilen: 8 GB RAM ve üzeri)

### Oracle SQL Developer Kurulumu

- Zip dosyası indirildikten sonra açılır.
    
- `sqldeveloper.exe` çalıştırılarak başlatılır.
    
- Menü görüntü problemi varsa **Tools → Preferences → Oracle → Windows** seçilmelidir.
    

---

## 3. Oracle Bağlantı Kurulumu

### Tarayıcı Üzerinden Bağlantı

1. Tarayıcıdan `http://localhost:8080/ords/sql-developer` adresi açılır.
    
2. Kullanıcı adı: `HR`
    
3. Şifre: `oracle`
    
4. Örnek sorgu:
    
    ```sql
    SELECT * FROM COUNTRIES WHERE REGION_ID = 1;
    ```
    

### Oracle SQL Developer ile Bağlantı

1. **Connections → + (New Connection)**
    
2. Bilgiler:
    
    - Name: `Oracle Sanal Makine`
        
    - Username: `HR`
        
    - Password: `oracle`
        
    - Hostname: `localhost`
        
    - Port: `1521`
        
    - Service name: `freepdb1`
        
3. **Test** → “Success” mesajı alınırsa bağlantı tamamdır.
    
4. Aynı yöntemle diğer şemalar (`OE`, `PM`, `IX`, `BI`, `SH`) da eklenebilir.
    

---

## 4. PL/SQL’e Giriş

PL/SQL, SQL’in yetersiz kaldığı yerlerde **kontrol yapıları, hata yönetimi, modülerlik** sağlar.  
Her PL/SQL komutu **noktalı virgül (;)** ile biter.  
Tip güvenli, taşınabilir ve modüler bir dildir.

### PL/SQL’in Sağladıkları

- **Prosedürler** ve **fonksiyonlar**
    
- **Koşullar** (`IF`, `CASE`)
    
- **Döngüler** (`LOOP`, `FOR`, `WHILE`)
    
- **İstisna yönetimi (EXCEPTION)**
    
- **Paketler** (package / package body)
    
- **Tip güvenliği** ve derleme zamanı kontrolü
    

### Avantajları

- Sunucu tarafında çalıştığı için hızlıdır.
    
- Modüler yapı kod bakımını kolaylaştırır.
    
- Farklı platformlarda taşınabilir.
    
- Java, C#, PHP gibi dillerden çağrılabilir.
    

---

## 5. PL/SQL Kod Mimarisi

PL/SQL kodları **iki ana yapıdadır**:

| Tür             | Açıklama                                                       | Özellik                                 |
| --------------- | -------------------------------------------------------------- | --------------------------------------- |
| **Anonim Blok** | Veri tabanına kaydedilmez, isimsizdir.                         | Her çalıştırmada yeniden derlenir.      |
| **İsimli Blok** | Veri tabanına kaydedilir (örneğin prosedür, fonksiyon, paket). | Derlenmiş hali saklanır, hızlı çalışır. |

---

### 5.1. Anonim Blok Yapısı

```sql
DECLARE
  -- değişken tanımlamaları
BEGIN
  -- çalıştırılabilir ifadeler
EXCEPTION
  -- hata yönetimi
END;
```

**Bölümler:**

1. **DECLARE** → Değişkenlerin tanımlandığı bölüm (isteğe bağlı)
    
2. **BEGIN … END** → Çalıştırılabilir komutlar (zorunlu)
    
3. **EXCEPTION** → Hataların yakalandığı bölüm (isteğe bağlı)
    

**Örnek:**

```sql
DECLARE
  v_name VARCHAR2(20);
BEGIN
  v_name := 'Ahmet';
  DBMS_OUTPUT.PUT_LINE('Merhaba ' || v_name);
END;
```

- İç içe bloklar (nested blocks) oluşturulabilir.
    
- Bloklara etiket verilebilir (`<<etiket>>`).
    

---

### 5.2. İsimli Blok Yapısı

| Yapı Türü                    | Açıklama                                          | Örnek                                        |
| ---------------------------- | ------------------------------------------------- | -------------------------------------------- |
| **Prosedür (Procedure)**     | Geri değer döndürmez                              | `CREATE PROCEDURE selamla IS ...`            |
| **Fonksiyon (Function)**     | `RETURN` ile değer döndürür                       | `CREATE FUNCTION topla RETURN NUMBER IS ...` |
| **Paket / Paket Gövdesi**    | Birden fazla altprogramı toplar                   | `CREATE PACKAGE personel_pkg AS ...`         |
| **Trigger / Type / Library** | Veritabanı olaylarını veya veri tiplerini yönetir | `CREATE TRIGGER ...`                         |

**Avantajları:**

- Performans (önceden derlenmiş halde saklanır)
    
- Modülerlik ve kodun tekrar kullanılabilirliği
    
- Taşınabilirlik ve kolay bakım
    

---

## 6. PL/SQL Girdi/Çıktı Komutları

### **Konsola Yazdırma**

```sql
SET SERVEROUTPUT ON;
BEGIN
  DBMS_OUTPUT.PUT_LINE('Merhaba PL/SQL!');
END;
```

- `DBMS_OUTPUT.PUT_LINE` → Satır sonu ekleyerek yazdırır.
    
- `DBMS_OUTPUT.PUT` → Satır sonu eklemeden yazar.
    

> Bu komutlar genelde test ve hata ayıklama aşamasında kullanılır.

### **Kullanıcıdan Girdi Alma**

```sql
ACCEPT sayi NUMBER PROMPT 'Bir sayı giriniz: '
DECLARE
  v_num NUMBER := &sayi;
BEGIN
  DBMS_OUTPUT.PUT_LINE('Girdiğiniz sayı: ' || v_num);
END;
```

- `&` operatörü kullanıcıdan girdi alır.
    

---

### Sonuç

- Oracle Database 23c Free sanal makine ile çalıştırılır.
    
- PL/SQL, SQL diline prosedürel özellikler kazandırır.
    
- Kodlar **anonim** veya **isimli blok** biçiminde yazılır.
    
- Üç ana bölüm: **DECLARE**, **BEGIN**, **EXCEPTION**.
    
- `DBMS_OUTPUT.PUT_LINE` ile çıktı alınır, `&` ile girdi istenir.
    
- İsimli bloklar derlenmiş biçimde saklandığı için performans sağlar.
    